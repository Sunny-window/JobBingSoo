<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Insert title here</title>
    <style>
        .filter-table {
            background-color: #f0f0f0;
            padding: 20px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .filter-table ul {
            display: flex;
            justify-content: space-between;
            list-style-type: none;
            padding: 0;
        }  
        .filter-box {
            margin-bottom: 10px;
        }
        .filter-box label {
            margin-left: 10px;
        }
        .keyword-btns {
            text-align: center;
            margin-top: 10px;
        }
        .keyword-btns .search {
            background-color: #FF006F;
            color: white;
            border: none;
            padding: 10px 20px;
            cursor: pointer;
            border-radius: 5px;
        }
        .keyword-btns .search:hover {
            background-color: #99004C;
        }

        .search-result {
            background-color: white;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }
        .search-result_top {
            text-align: center;
            margin: 20px 0;
        }
        .result-list_left {
            display: flex;
            align-items: center;
            text-decoration: none;
            color: inherit;
            border: 1px solid #ddd;
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 5px;
        }
        .co-logo {
            width: 50px;
            height: 50px;
            background-color: #f0f0f0;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-right: 20px;
            border-radius: 50%;
        }
        .co-info {
            display: flex;
            flex-direction: column;
        }
        .co-hd {
            font-size: 1.2em;
            font-weight: bold;
        }
        .co-detail {
            color: gray;
        }
    </style>
</head>
<body>
    <header><div th:replace="/sub/header"></div></header>
    <section>
        <div class="heading">
            <h2 class="tip">필터링</h2>
        </div>
        <div class="filter-table">
            <ul>
                <li>
                    <h4>매출액</h4>
                    <div class="filter-box">
                        <input type="checkbox" id="keyword1_1" class="chkwrd" value="~3000" name="keyword1">
                        <label for="keyword1_1">~3000</label>
                    </div>
                    <div class="filter-box">
                        <input type="checkbox" id="keyword1_2" class="chkwrd" value="3000~5000" name="keyword1">
                        <label for="keyword1_2">3000~5000</label>
                    </div>
                    <div class="filter-box">
                        <input type="checkbox" id="keyword1_3" class="chkwrd" value="5000~7000" name="keyword1">
                        <label for="keyword1_3">5000~7000</label>
                    </div>
                    <div class="filter-box">
                        <input type="checkbox" id="keyword1_4" class="chkwrd" value="7000~" name="keyword1">
                        <label for="keyword1_4">7000~</label>
                    </div>                                    
                </li>
                <li>
                    <h4>회사 규모</h4>
                    <div class="filter-box">
                        <input type="checkbox" id="keyword2_5" class="chkwrd" value="대기업" name="keyword2">
                        <label for="keyword2_5">대기업</label>
                    </div>
                    <div class="filter-box">
                        <input type="checkbox" id="keyword2_6" class="chkwrd" value="중견기업" name="keyword2">
                        <label for="keyword2_6">중견기업</label>
                    </div>
                    <div class="filter-box">
                        <input type="checkbox" id="keyword2_7" class="chkwrd" value="중소기업" name="keyword2">
                        <label for="keyword2_7">중소기업</label>
                    </div>                                    
                </li>
                <li>
                    <h4>업종</h4>
                    <div class="filter-box">
                        <input type="checkbox" id="keyword3_8" class="chkwrd" value="01. 사업관리" name="keyword3">
                        <label for="keyword2_8">01. 사업관리</label>
                    </div>
                    <div class="filter-box">
                        <input type="checkbox" id="keyword3_9" class="chkwrd" value="02. 경영·회계·사무" name="keyword3">
                        <label for="keyword2_9">02. 경영·회계·사무</label>
                    </div>
                    <div class="filter-box">
                        <input type="checkbox" id="keyword3_10" class="chkwrd" value="03. 금융·보험" name="keyword3">
                        <label for="keyword2_10">03. 금융·보험</label>
                    </div>
                    <div class="filter-box">
                        <input type="checkbox" id="keyword3_11" class="chkwrd" value="04. 교육·자연·사회과학" name="keyword3">
                        <label for="keyword2_11">04. 교육·자연·사회과학</label>
                    </div>
                    <div class="filter-box">
                        <input type="checkbox" id="keyword3_12" class="chkwrd" value="05. 법률·경찰·소방·교도·국방" name="keyword3">
                        <label for="keyword2_12">05. 법률·경찰·소방·교도·국방</label>
                    </div>
                    <div class="filter-box">
                        <input type="checkbox" id="keyword3_13" class="chkwrd" value="06. 보건·의료" name="keyword3">
                        <label for="keyword2_13">06. 보건·의료</label>
                    </div>
                    <div class="filter-box">
                        <input type="checkbox" id="keyword3_14" class="chkwrd" value="07. 사회복지·종교" name="keyword3">
                        <label for="keyword2_14">07. 사회복지·종교</label>
                    </div>
                    <div class="filter-box">
                        <input type="checkbox" id="keyword3_15" class="chkwrd" value="08. 문화·예술·디자인·방송" name="keyword3">
                        <label for="keyword2_15">08. 문화·예술·디자인·방송</label>
                    </div>
                    <div class="filter-box">
                        <input type="checkbox" id="keyword3_16" class="chkwrd" value="09. 운전·운송" name="keyword3">
                        <label for="keyword2_16">09. 운전·운송</label>
                    </div>
                    <div class="filter-box">
                        <input type="checkbox" id="keyword3_17" class="chkwrd" value="10. 영업판매" name="keyword3">
                        <label for="keyword2_17">10. 영업판매</label>
                    </div>
                    <div class="filter-box">
                        <input type="checkbox" id="keyword3_18" class="chkwrd" value="11. 경비·청소" name="keyword3">
                        <label for="keyword2_18">11. 경비·청소</label>
                    </div>
                    <div class="filter-box">
                        <input type="checkbox" id="keyword3_19" class="chkwrd" value="12. 이용·숙박·여행·오락·스포츠" name="keyword3">
                        <label for="keyword2_19">12. 이용·숙박·여행·오락·스포츠</label>
                    </div>
                    <div class="filter-box">
                        <input type="checkbox" id="keyword3_20" class="chkwrd" value="13. 음식서비스" name="keyword3">
                        <label for="keyword2_20">13. 음식서비스</label>
                    </div>
                    <div class="filter-box">
                        <input type="checkbox" id="keyword3_21" class="chkwrd" value="14. 건설" name="keyword3">
                        <label for="keyword2_21">14. 건설</label>
                    </div>
                    <div class="filter-box">
                        <input type="checkbox" id="keyword3_22" class="chkwrd" value="15. 기계" name="keyword3">
                        <label for="keyword2_22">15. 기계</label>
                    </div>
                    <div class="filter-box">
                        <input type="checkbox" id="keyword3_23" class="chkwrd" value="16. 재료" name="keyword3">
                        <label for="keyword2_23">16. 재료</label>
                    </div>
                    <div class="filter-box">
                        <input type="checkbox" id="keyword3_24" class="chkwrd" value="17. 화학·바이오" name="keyword3">
                        <label for="keyword2_24">17. 화학·바이오</label>
                    </div>
                    <div class="filter-box">
                        <input type="checkbox" id="keyword3_25" class="chkwrd" value="18. 섬유·의복" name="keyword3">
                        <label for="keyword2_25">18. 섬유·의복</label>
                    </div>
                    <div class="filter-box">
                        <input type="checkbox" id="keyword3_26" class="chkwrd" value="19. 전기·전자" name="keyword3">
                        <label for="keyword2_26">19. 전기·전자</label>
                    </div>
                    <div class="filter-box">
                        <input type="checkbox" id="keyword3_27" class="chkwrd" value="20. 정보통신" name="keyword3">
                        <label for="keyword2_27">20. 정보통신</label>
                    </div>
                    <div class="filter-box">
                        <input type="checkbox" id="keyword3_28" class="chkwrd" value="21. 식품가공" name="keyword3">
                        <label for="keyword2_28">21. 식품가공</label>
                    </div>
                    <div class="filter-box">
                        <input type="checkbox" id="keyword3_29" class="chkwrd" value="22. 인쇄·목재·가구·공예" name="keyword3">
                        <label for="keyword2_29">22. 인쇄·목재·가구·공예</label>
                    </div>
                    <div class="filter-box">
                        <input type="checkbox" id="keyword3_30" class="chkwrd" value="23. 환경·에너지·안전" name="keyword3">
                        <label for="keyword2_30">23. 환경·에너지·안전</label>
                    </div>
                    <div class="filter-box">
                        <input type="checkbox" id="keyword3_31" class="chkwrd" value="24. 농림어업" name="keyword3">
                        <label for="keyword2_31">24. 농림어업</label>
                    </div>
                </li>      
            </ul>
            <div class="keyword-btns">
                <button class="search" id="kwrdSearch">선택된 조건 검색</button>
            </div>
        </div>

        <div id="search-result" class="search-result">
            <div class="search-result_top">
                <p>검색 결과 <span id="result-count">_건</span></p>
            </div>
            <ul id="result-list"></ul>
        </div>

        <script>
            document.addEventListener("DOMContentLoaded", function() {
                // 기본적으로 전체 결과를 로드합니다.
                fetch("http://localhost:9001/main/company-list")
                    .then(response => response.json())
                    .then(data => {
                        displayCompanies(data);
                    })
                    .catch(error => console.error('Error fetching company data:', error));

                document.getElementById("kwrdSearch").addEventListener("click", function() {
                    const filters = {
                        sales: [],
                        size: [],
                        industry: []
                    };

                    document.querySelectorAll('input[name="keyword1"]:checked').forEach(checkbox => {
                        filters.sales.push(checkbox.value);
                    });

                    document.querySelectorAll('input[name="keyword2"]:checked').forEach(checkbox => {
                        filters.size.push(checkbox.value);
                    });

                    document.querySelectorAll('input[name="keyword3"]:checked').forEach(checkbox => {
                        filters.industry.push(checkbox.value);
                    });

                    fetch("http://localhost:9001/main/company-list/filter", {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(filters)
                    })
                    .then(response => response.json())
                    .then(data => {
                        displayCompanies(data);
                    })
                    .catch(error => console.error('Error fetching company data:', error));
                });

                function displayCompanies(data) {
                    const resultList = document.getElementById("result-list");
                    resultList.innerHTML = ""; // Clear existing content

                    data.forEach(company => {
                        const listItem = document.createElement("li");
                        
                        listItem.innerHTML = `
                            <div>
                                <a href="http://localhost:8080/main/comDetail?cno=${company.cno}" class="result-list_left co">
                                    <div class="co-logo none">
                                        <span>${company.companyName.charAt(0)}</span>
                                    </div>
                                    <div class="co-info">
                                        <div class="co-hd">
                                            <span class="co-name">${company.companyName}</span>
                                        </div>
                                        <div class="co-detail">
                                            <span>${company.subCategoryName}</span>
                                        </div>
                                    </div>  
                                </a>
                            </div>
                        `;
                        
                        resultList.appendChild(listItem);
                    });

                    document.getElementById("result-count").textContent = `${data.length} 건`;
                }
            });
        </script>
    </section>
    <footer>
        <div th:replace="/sub/footer"></div>
    </footer>
</body>
</html>
